\hypertarget{linearSolver_8h}{}\doxysection{ccfd/src/linear\+Solver.h File Reference}
\label{linearSolver_8h}\index{ccfd/src/linearSolver.h@{ccfd/src/linearSolver.h}}
{\ttfamily \#include $<$stdbool.\+h$>$}\newline
{\ttfamily \#include \char`\"{}main.\+h\char`\"{}}\newline
{\ttfamily \#include \char`\"{}mesh.\+h\char`\"{}}\newline
Include dependency graph for linear\+Solver.\+h\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=226pt]{linearSolver_8h__incl}
\end{center}
\end{figure}
This graph shows which files directly or indirectly include this file\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{linearSolver_8h__dep__incl}
\end{center}
\end{figure}
\doxysubsection*{Functions}
\begin{DoxyCompactItemize}
\item 
\mbox{\Hypertarget{linearSolver_8h_ae169561793e8ff5ed9b88eb5eb7a0326}\label{linearSolver_8h_ae169561793e8ff5ed9b88eb5eb7a0326}} 
void \mbox{\hyperlink{linearSolver_8h_ae169561793e8ff5ed9b88eb5eb7a0326}{init\+Linear\+Solver}} (void)
\begin{DoxyCompactList}\small\item\em Initialize linear solver. \end{DoxyCompactList}\item 
double \mbox{\hyperlink{linearSolver_8h_ad8c72a0c1caceac1554d2a014545442f}{vector\+Dot\+Product}} (double $\ast$$\ast$A, double $\ast$$\ast$B)
\begin{DoxyCompactList}\small\item\em Compute dot product for two state vectors A and B for every element. \end{DoxyCompactList}\item 
void \mbox{\hyperlink{linearSolver_8h_a833d8d138090b96271adb61a241c49f4}{G\+M\+R\+E\+S\+\_\+M}} (double time, double dt, double \mbox{\hyperlink{initialCondition_8h_a20f4c4490bc8ecbdd1ffcb79acce6035}{alpha}}, double $\ast$$\ast$B, double normB, double $\ast$abort\+Crit, double $\ast$$\ast$\mbox{\hyperlink{timeDiscretization_8c_aa715af0ec46017046eb70c8787b7854b}{deltaX}})
\begin{DoxyCompactList}\small\item\em Uses matrix free to solve the linear system. \end{DoxyCompactList}\item 
\mbox{\Hypertarget{linearSolver_8h_ab49b5b210a947acdec5ca4ff058d9ba4}\label{linearSolver_8h_ab49b5b210a947acdec5ca4ff058d9ba4}} 
void \mbox{\hyperlink{linearSolver_8h_ab49b5b210a947acdec5ca4ff058d9ba4}{free\+Linear\+Solver}} (void)
\begin{DoxyCompactList}\small\item\em Free all memory that was allocated for. \end{DoxyCompactList}\end{DoxyCompactItemize}
\doxysubsection*{Variables}
\begin{DoxyCompactItemize}
\item 
int \mbox{\hyperlink{linearSolver_8h_a32be4c35332a5236db05a707a422a711}{n\+Kdim}}
\item 
int \mbox{\hyperlink{linearSolver_8h_a9e698a12f1405edd0b14d5e70d4a890f}{n\+Newton\+Iter}}
\item 
int \mbox{\hyperlink{linearSolver_8h_ae136204fc2205a21023230d7580c1c36}{n\+Newton\+Iter\+Global}}
\item 
int \mbox{\hyperlink{linearSolver_8h_aa276912d8778a829131220de9d7e9844}{n\+G\+M\+R\+E\+Siter\+Global}}
\item 
int \mbox{\hyperlink{linearSolver_8h_af98da90358e76525add3839c61fdbd2d}{n\+Inner\+Newton}}
\item 
int \mbox{\hyperlink{linearSolver_8h_a944cd45a741f9dea609b4c5cfa1ffd4f}{n\+Inner\+G\+M\+R\+ES}}
\item 
bool \mbox{\hyperlink{linearSolver_8h_afb497e8766ebb2549198f4a1ed0115a0}{use\+Precond}}
\item 
double \mbox{\hyperlink{linearSolver_8h_a834b3496fc26d27d58b1f45789babe66}{r\+Eps0}}
\item 
double \mbox{\hyperlink{linearSolver_8h_a448267f322e74a68c1159206d4b14b94}{sr\+Eps0}}
\item 
double \mbox{\hyperlink{linearSolver_8h_a95bfe70fb475978b534a64e3acf2040e}{eps2newton}}
\item 
double \mbox{\hyperlink{linearSolver_8h_ad0251ae2ddee799f670b4e5fc6474e6a}{eps2newton\+\_\+sq}}
\item 
double \mbox{\hyperlink{linearSolver_8h_a842f385c4b1df56339ee2bd6c220bdf0}{eps\+G\+M\+R\+ES}}
\item 
double \mbox{\hyperlink{linearSolver_8h_ae924a03f59827f55c3c5b474c89d07d6}{gam\+EW}}
\item 
double $\ast$$\ast$ \mbox{\hyperlink{linearSolver_8h_a2512c967317cac30177521b81511d2d6}{XK}}
\item 
double $\ast$$\ast$ \mbox{\hyperlink{linearSolver_8h_afcc6752617c005ff4974f7b68378ca67}{R\+\_\+\+XK}}
\end{DoxyCompactItemize}


\doxysubsection{Detailed Description}
\begin{DoxyAuthor}{Author}
hhh 
\end{DoxyAuthor}
\begin{DoxyDate}{Date}
Sat 28 Mar 2020 03\+:09\+:46 PM C\+ET 
\end{DoxyDate}


\doxysubsection{Function Documentation}
\mbox{\Hypertarget{linearSolver_8h_a833d8d138090b96271adb61a241c49f4}\label{linearSolver_8h_a833d8d138090b96271adb61a241c49f4}} 
\index{linearSolver.h@{linearSolver.h}!GMRES\_M@{GMRES\_M}}
\index{GMRES\_M@{GMRES\_M}!linearSolver.h@{linearSolver.h}}
\doxysubsubsection{\texorpdfstring{GMRES\_M()}{GMRES\_M()}}
{\footnotesize\ttfamily void G\+M\+R\+E\+S\+\_\+M (\begin{DoxyParamCaption}\item[{double}]{time,  }\item[{double}]{dt,  }\item[{double}]{alpha,  }\item[{double $\ast$$\ast$}]{B,  }\item[{double}]{normB,  }\item[{double $\ast$}]{abort\+Crit,  }\item[{double $\ast$$\ast$}]{delX }\end{DoxyParamCaption})}



Uses matrix free to solve the linear system. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\texttt{ in}}  & {\em time} & Computation time at calculation \\
\hline
\mbox{\texttt{ in}}  & {\em dt} & Time step at calculation \\
\hline
\mbox{\texttt{ in}}  & {\em alpha} & Relaxation parameter \\
\hline
\mbox{\texttt{ in}}  & {\em B} & Right hand side \\
\hline
\mbox{\texttt{ in}}  & {\em normB} & Norm of right hand side \\
\hline
\mbox{\texttt{ in,out}}  & {\em abort\+Crit} & G\+M\+R\+ES abort criterium \\
\hline
\mbox{\texttt{ out}}  & {\em delX} & Resulting x vector of the linear system \\
\hline
\end{DoxyParams}


References alpha, build\+Matrix(), E, eps\+G\+M\+R\+ES, gam, L\+U\+S\+G\+S(), matrix\+Vector(), MX, MY, n\+Elems, n\+G\+M\+R\+E\+Siter\+Global, n\+Inner\+G\+M\+R\+ES, n\+Kdim, R0, R\+HO, t, use\+Precond, V, vector\+Dot\+Product(), W, and Z.



Referenced by implicit\+Time\+Step().

\mbox{\Hypertarget{linearSolver_8h_ad8c72a0c1caceac1554d2a014545442f}\label{linearSolver_8h_ad8c72a0c1caceac1554d2a014545442f}} 
\index{linearSolver.h@{linearSolver.h}!vectorDotProduct@{vectorDotProduct}}
\index{vectorDotProduct@{vectorDotProduct}!linearSolver.h@{linearSolver.h}}
\doxysubsubsection{\texorpdfstring{vectorDotProduct()}{vectorDotProduct()}}
{\footnotesize\ttfamily double vector\+Dot\+Product (\begin{DoxyParamCaption}\item[{double $\ast$$\ast$}]{A,  }\item[{double $\ast$$\ast$}]{B }\end{DoxyParamCaption})}



Compute dot product for two state vectors A and B for every element. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\texttt{ in}}  & {\em A} & First state vector for every element \\
\hline
\mbox{\texttt{ in}}  & {\em B} & Second state vector for every element \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
sum(sum(A\+\_\+ij $\ast$ B\+\_\+ij, i = R\+HO,MX,MY,E), i = 1..n\+Elems) 
\end{DoxyReturn}


References E, MX, MY, n\+Elems, and R\+HO.



Referenced by G\+M\+R\+E\+S\+\_\+\+M(), implicit\+Time\+Step(), and matrix\+Vector().



\doxysubsection{Variable Documentation}
\mbox{\Hypertarget{linearSolver_8h_a95bfe70fb475978b534a64e3acf2040e}\label{linearSolver_8h_a95bfe70fb475978b534a64e3acf2040e}} 
\index{linearSolver.h@{linearSolver.h}!eps2newton@{eps2newton}}
\index{eps2newton@{eps2newton}!linearSolver.h@{linearSolver.h}}
\doxysubsubsection{\texorpdfstring{eps2newton}{eps2newton}}
{\footnotesize\ttfamily double eps2newton}

square of newton relative epsilon 

Referenced by implicit\+Time\+Step(), and init\+Linear\+Solver().

\mbox{\Hypertarget{linearSolver_8h_ad0251ae2ddee799f670b4e5fc6474e6a}\label{linearSolver_8h_ad0251ae2ddee799f670b4e5fc6474e6a}} 
\index{linearSolver.h@{linearSolver.h}!eps2newton\_sq@{eps2newton\_sq}}
\index{eps2newton\_sq@{eps2newton\_sq}!linearSolver.h@{linearSolver.h}}
\doxysubsubsection{\texorpdfstring{eps2newton\_sq}{eps2newton\_sq}}
{\footnotesize\ttfamily double eps2newton\+\_\+sq}

newton relative epsilon 

Referenced by implicit\+Time\+Step(), and init\+Linear\+Solver().

\mbox{\Hypertarget{linearSolver_8h_a842f385c4b1df56339ee2bd6c220bdf0}\label{linearSolver_8h_a842f385c4b1df56339ee2bd6c220bdf0}} 
\index{linearSolver.h@{linearSolver.h}!epsGMRES@{epsGMRES}}
\index{epsGMRES@{epsGMRES}!linearSolver.h@{linearSolver.h}}
\doxysubsubsection{\texorpdfstring{epsGMRES}{epsGMRES}}
{\footnotesize\ttfamily double eps\+G\+M\+R\+ES}

G\+M\+R\+ES relative epsilon 

Referenced by G\+M\+R\+E\+S\+\_\+\+M(), and init\+Linear\+Solver().

\mbox{\Hypertarget{linearSolver_8h_ae924a03f59827f55c3c5b474c89d07d6}\label{linearSolver_8h_ae924a03f59827f55c3c5b474c89d07d6}} 
\index{linearSolver.h@{linearSolver.h}!gamEW@{gamEW}}
\index{gamEW@{gamEW}!linearSolver.h@{linearSolver.h}}
\doxysubsubsection{\texorpdfstring{gamEW}{gamEW}}
{\footnotesize\ttfamily double gam\+EW}

gamma parameter for Eisenstat Walker 

Referenced by implicit\+Time\+Step(), and init\+Linear\+Solver().

\mbox{\Hypertarget{linearSolver_8h_aa276912d8778a829131220de9d7e9844}\label{linearSolver_8h_aa276912d8778a829131220de9d7e9844}} 
\index{linearSolver.h@{linearSolver.h}!nGMRESiterGlobal@{nGMRESiterGlobal}}
\index{nGMRESiterGlobal@{nGMRESiterGlobal}!linearSolver.h@{linearSolver.h}}
\doxysubsubsection{\texorpdfstring{nGMRESiterGlobal}{nGMRESiterGlobal}}
{\footnotesize\ttfamily int n\+G\+M\+R\+E\+Siter\+Global}

global number of G\+M\+R\+ES iterations 

Referenced by G\+M\+R\+E\+S\+\_\+\+M(), init\+Linear\+Solver(), and time\+Disc().

\mbox{\Hypertarget{linearSolver_8h_a944cd45a741f9dea609b4c5cfa1ffd4f}\label{linearSolver_8h_a944cd45a741f9dea609b4c5cfa1ffd4f}} 
\index{linearSolver.h@{linearSolver.h}!nInnerGMRES@{nInnerGMRES}}
\index{nInnerGMRES@{nInnerGMRES}!linearSolver.h@{linearSolver.h}}
\doxysubsubsection{\texorpdfstring{nInnerGMRES}{nInnerGMRES}}
{\footnotesize\ttfamily int n\+Inner\+G\+M\+R\+ES}

maximum number of G\+M\+R\+ES iterations for one stage 

Referenced by G\+M\+R\+E\+S\+\_\+\+M(), and init\+Linear\+Solver().

\mbox{\Hypertarget{linearSolver_8h_af98da90358e76525add3839c61fdbd2d}\label{linearSolver_8h_af98da90358e76525add3839c61fdbd2d}} 
\index{linearSolver.h@{linearSolver.h}!nInnerNewton@{nInnerNewton}}
\index{nInnerNewton@{nInnerNewton}!linearSolver.h@{linearSolver.h}}
\doxysubsubsection{\texorpdfstring{nInnerNewton}{nInnerNewton}}
{\footnotesize\ttfamily int n\+Inner\+Newton}

maximum number of Newton iterations for one stage 

Referenced by implicit\+Time\+Step(), and init\+Linear\+Solver().

\mbox{\Hypertarget{linearSolver_8h_a32be4c35332a5236db05a707a422a711}\label{linearSolver_8h_a32be4c35332a5236db05a707a422a711}} 
\index{linearSolver.h@{linearSolver.h}!nKdim@{nKdim}}
\index{nKdim@{nKdim}!linearSolver.h@{linearSolver.h}}
\doxysubsubsection{\texorpdfstring{nKdim}{nKdim}}
{\footnotesize\ttfamily int n\+Kdim}

number Krylov spaces 

Referenced by G\+M\+R\+E\+S\+\_\+\+M(), and init\+Linear\+Solver().

\mbox{\Hypertarget{linearSolver_8h_a9e698a12f1405edd0b14d5e70d4a890f}\label{linearSolver_8h_a9e698a12f1405edd0b14d5e70d4a890f}} 
\index{linearSolver.h@{linearSolver.h}!nNewtonIter@{nNewtonIter}}
\index{nNewtonIter@{nNewtonIter}!linearSolver.h@{linearSolver.h}}
\doxysubsubsection{\texorpdfstring{nNewtonIter}{nNewtonIter}}
{\footnotesize\ttfamily int n\+Newton\+Iter}

maximum number of Newton iterations 

Referenced by implicit\+Time\+Step(), and init\+Linear\+Solver().

\mbox{\Hypertarget{linearSolver_8h_ae136204fc2205a21023230d7580c1c36}\label{linearSolver_8h_ae136204fc2205a21023230d7580c1c36}} 
\index{linearSolver.h@{linearSolver.h}!nNewtonIterGlobal@{nNewtonIterGlobal}}
\index{nNewtonIterGlobal@{nNewtonIterGlobal}!linearSolver.h@{linearSolver.h}}
\doxysubsubsection{\texorpdfstring{nNewtonIterGlobal}{nNewtonIterGlobal}}
{\footnotesize\ttfamily int n\+Newton\+Iter\+Global}

global number of Newton iterations 

Referenced by implicit\+Time\+Step(), init\+Linear\+Solver(), and time\+Disc().

\mbox{\Hypertarget{linearSolver_8h_afcc6752617c005ff4974f7b68378ca67}\label{linearSolver_8h_afcc6752617c005ff4974f7b68378ca67}} 
\index{linearSolver.h@{linearSolver.h}!R\_XK@{R\_XK}}
\index{R\_XK@{R\_XK}!linearSolver.h@{linearSolver.h}}
\doxysubsubsection{\texorpdfstring{R\_XK}{R\_XK}}
{\footnotesize\ttfamily double$\ast$$\ast$ R\+\_\+\+XK}

residual of kth vector array 

Referenced by build\+Matrix(), free\+Linear\+Solver(), implicit\+Time\+Step(), init\+Linear\+Solver(), and matrix\+Vector().

\mbox{\Hypertarget{linearSolver_8h_a834b3496fc26d27d58b1f45789babe66}\label{linearSolver_8h_a834b3496fc26d27d58b1f45789babe66}} 
\index{linearSolver.h@{linearSolver.h}!rEps0@{rEps0}}
\index{rEps0@{rEps0}!linearSolver.h@{linearSolver.h}}
\doxysubsubsection{\texorpdfstring{rEps0}{rEps0}}
{\footnotesize\ttfamily double r\+Eps0}

D\+B\+L\+\_\+\+E\+P\+S\+I\+L\+ON 

Referenced by build\+Matrix(), init\+Linear\+Solver(), and matrix\+Vector().

\mbox{\Hypertarget{linearSolver_8h_a448267f322e74a68c1159206d4b14b94}\label{linearSolver_8h_a448267f322e74a68c1159206d4b14b94}} 
\index{linearSolver.h@{linearSolver.h}!srEps0@{srEps0}}
\index{srEps0@{srEps0}!linearSolver.h@{linearSolver.h}}
\doxysubsubsection{\texorpdfstring{srEps0}{srEps0}}
{\footnotesize\ttfamily double sr\+Eps0}

sqrt(\+D\+B\+L\+\_\+\+E\+P\+S\+I\+L\+O\+N) 

Referenced by build\+Matrix(), and init\+Linear\+Solver().

\mbox{\Hypertarget{linearSolver_8h_afb497e8766ebb2549198f4a1ed0115a0}\label{linearSolver_8h_afb497e8766ebb2549198f4a1ed0115a0}} 
\index{linearSolver.h@{linearSolver.h}!usePrecond@{usePrecond}}
\index{usePrecond@{usePrecond}!linearSolver.h@{linearSolver.h}}
\doxysubsubsection{\texorpdfstring{usePrecond}{usePrecond}}
{\footnotesize\ttfamily bool use\+Precond}

use L\+U\+S\+GS preconditioner flag 

Referenced by free\+Linear\+Solver(), G\+M\+R\+E\+S\+\_\+\+M(), and init\+Linear\+Solver().

\mbox{\Hypertarget{linearSolver_8h_a2512c967317cac30177521b81511d2d6}\label{linearSolver_8h_a2512c967317cac30177521b81511d2d6}} 
\index{linearSolver.h@{linearSolver.h}!XK@{XK}}
\index{XK@{XK}!linearSolver.h@{linearSolver.h}}
\doxysubsubsection{\texorpdfstring{XK}{XK}}
{\footnotesize\ttfamily double$\ast$$\ast$ XK}

kth X vector array 

Referenced by free\+Linear\+Solver(), implicit\+Time\+Step(), init\+Linear\+Solver(), and matrix\+Vector().

